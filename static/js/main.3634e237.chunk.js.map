{"version":3,"sources":["components/ToolboxLayout.js","components/Tags.js","components/Highlight.js","components/AppSuperTile.js","components/AppFullSizeTile.js","helpers/ImplicitMSALAuthenticationProvider.js","helpers/OfficeGraph.js","config/index.js","App.js","serviceWorker.js","index.js","helpers/index.js","config/nets/logo_intranets.png"],"names":["ResponsiveReactGridLayout","WidthProvider","Responsive","ToolBoxItem","className","onClick","this","props","onTakeItem","bind","undefined","item","i","React","Component","generateLayout","_","map","range","y","Math","ceil","random","x","floor","w","h","toString","static","onBreakpointChange","breakpoint","setState","prevState","currentBreakpoint","toolbox","onCompactTypeChange","oldCompactType","state","compactType","filter","layouts","onPutItem","onLayoutChange","layout","key","value","global","localStorage","setItem","JSON","stringify","persist","onNewLayout","lg","mounted","tools","tool","ix","initialLayout","that","l","tile","title","style","backgroundColor","color","textcolor","cursor","editingLayout","onTileClick","src","icon","height","maxHeight","width","padding","isDraggable","measureBeforeMount","useCSSTransforms","preventCollision","generateDOM","defaultProps","rowHeight","cols","md","sm","xs","xxs","Tags","references","display","flexWrap","group","margin","textColor","Highlight","text","toLowerCase","indexOf","first","substr","middle","length","last","AppSuperTile","useState","tileSize","border","maxWidth","borderRadius","overflow","marginTop","flexGrow","lineHeight","marginLeft","fontSize","highlightStyle","alignItems","class","isPinned","e","onPinnedClicked","preventDefault","stopPropagation","aria-hidden","textAlign","inShort","justifyContent","externalArticle","href","rel","target","AppFullSizeTile","html","setHtml","error","setError","useEffect","contentRef","axios","get","then","result","converter","QuillDeltaToHtmlConverter","data","ops","convert","catch","response","status","message","onClose","minWidth","textOverflow","whiteSpace","paddingLeft","jumpto","dangerouslySetInnerHTML","__html","inIframe","window","self","top","ImplicitMSALAuthenticationProvider","msalApplication","options","authenticationProviderOptions","Promise","resolve","reject","a","scopes","Error","name","handleRedirectCallback","getAccount","tokenRequest","acquireTokenSilent","authResponse","accessToken","InteractionRequiredAuthError","acquireTokenPopup","loginPopup","loginRedirect","XLSX","require","graphScopes","msalConfig","auth","clientId","redirectUri","location","protocol","hostname","port","pathname","authority","Msal","authProvider","MSALAuthenticationProviderOptions","buffer","pending","getClient","Client","initWithMiddleware","path","client","api","getTileXLSX","toolFolder","id","url","method","responseType","wb","read","type","Sheets","ZTICKYBAR","rows","utils","sheet_to_json","header","raw","forEach","row","getFile","folder","filename","getMyTool","tileData","blobToBase64","blob","blobUrl","URL","createObjectURL","xhr","XMLHttpRequest","onload","recoveredBlob","reader","FileReader","blobAsDataUrl","readAsDataURL","open","send","delaywriteLayouts","setTimeout","console","log","writing","writeLayouts","LAYOUTSJSON","properties","useLocalStorage","version","isEqual","current","put","me","rootSite","initStorage","ztickyFolder","statusCode","driveItem","post","initTileStorage","addTile","folderName","tableId","replace","keys","prop","push","workbook","book_new","ws","aoa_to_sheet","book_append_sheet","wopts","bookType","bookSST","wbout","write","getMyTools","refresh","cache","getItem","parse","folders","queueLength","teamMemberships","groups","memberships","photo","base64","details","channels","displayName","description","sort","b","readLayouts","logo","itemType","DropdownMenuItemType","Header","web","Divider","components","borderBottom","initializeIcons","Boolean","match","ReactDOM","render","titlegraphics","setTitlegraphics","setFilter","tiles","setTiles","useAuthentication","isZoomed","setIsZoomed","currentTile","setCurrentTile","setMe","setZtickyFolder","myTools","setMyTools","ztickyRef","setZtickyRef","errors","setErrors","refreshing","setRefresing","progress","setProgress","showTable","showFilterOptions","tableUrl","setTableUrl","setLayouts","selectedGroup","setGroups","inFrame","initGraph","removeItem","queueCount","OfficeGraph","tileFolders","context","matchFilter","subTitle","userDetails","document","search","s1","split","s2","index","s3","decodeURIComponent","getSearchParametersFromHRef","ztickyref","config","defaultTableAPI","grid","groupRefs","cell","groupSetting","members","refs","ga","sortBy","correlation","readGrid","defaultTableKey","filteredTiles","filteredMyTools","filteredMemberShips","team","channel","matchTeam","paddingRight","position","ProgressIndicator","xlabel","bottom","right","webUrl","zIndex","marginRight","TextField","disabled","onChange","newValue","placeholder","iconProps","iconName","r","Infinity","finally","borderLeft","borderTop","float","label","getElementById","navigator","serviceWorker","ready","registration","unregister","module","exports"],"mappings":"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","file":"static/js/main.3634e237.chunk.js","sourcesContent":["import React from \"react\";\nimport _ from \"lodash\";\nimport { Responsive, WidthProvider } from \"react-grid-layout\";\nimport \"./Toolbox.css\";\nconst ResponsiveReactGridLayout = WidthProvider(Responsive);\n\nclass ToolBoxItem extends React.Component {\n  render() {\n    return (\n      <div\n        className=\"toolbox__items__item\"\n        onClick={this.props.onTakeItem.bind(undefined, this.props.item)}\n      >\n        {this.props.item.i}\n      </div>\n    );\n  }\n}\nclass ToolBox extends React.Component {\n  render() {\n    return (\n      <div className=\"toolbox\">\n        <span className=\"toolbox__title\">Toolbox</span>\n        <div className=\"toolbox__items\">\n          {this.props.items.map(item => (\n            <ToolBoxItem\n              key={item.i}\n              item={item}\n              onTakeItem={this.props.onTakeItem}\n            />\n          ))}\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default class ToolboxLayout extends React.Component {\n  static defaultProps = {\n    className: \"layout\",\n    rowHeight: 30,\n    onLayoutChange: function() {},\n    cols: { lg: 12, md: 10, sm: 6, xs: 4, xxs: 2 },\n    initialLayout: generateLayout()\n  };\n\n  constructor(props) {\n    super(props);\n    \n    this.state = {\n      currentBreakpoint: \"lg\",\n      compactType: \"vertical\",\n      mounted: false,\n      layouts: props.layouts ? props.layouts : {\n        lg: props.tools\n          ? props.tools.map((tool, ix) => {\n              return {\n                x: 0,\n                y: ix,\n                w:3,\n                h:3,\n               \n                i: ix.toString(),\n\n                static: 0 //Math.random() < 0.05,\n              };\n            })\n          : props.initialLayout\n      },\n      toolbox: { lg: [] }\n    };\n  }\n\n  componentDidMount() {\n    this.setState({ mounted: true });\n  }\n\n  generateDOM() {\n    var that = this;\n    return _.map(this.state.layouts[this.state.currentBreakpoint], l => {\n      var tile = that.props.tools && that.props.tools[l.i] &&  that.props.tools[l.i].tile?   that.props.tools[l.i].tile : {title:l.i};\n      return (\n        <div  style={{backgroundColor:tile.color,color:tile.textcolor,cursor:!this.props.editingLayout ? \"pointer\" :\"default\"}}  \n        onClick={()=>{if (this.props.onTileClick &&  !this.props.editingLayout){this.props.onTileClick(tile)}}}\n        key={l.i} className={l.static ? \"static\" : \"\"}>\n          \n              <img src={tile.icon} style={{height:\"100%\",maxHeight:\"128px\",width:\"auto\",padding:\"8px\"}}></img>\n            <span className=\"text\">{tile.title } </span>\n          \n        </div>\n      );\n    });\n  }\n\n  \n \n  onBreakpointChange = breakpoint => {\n    this.setState(prevState => ({\n      currentBreakpoint: breakpoint,\n      toolbox: {\n        ...prevState.toolbox,\n        [breakpoint]:\n          prevState.toolbox[breakpoint] ||\n          prevState.toolbox[prevState.currentBreakpoint] ||\n          []\n      }\n    }));\n  };\n\n  onCompactTypeChange = () => {\n    const { compactType: oldCompactType } = this.state;\n    const compactType =\n      oldCompactType === \"horizontal\"\n        ? \"vertical\"\n        : oldCompactType === \"vertical\"\n        ? null\n        : \"horizontal\";\n    this.setState({ compactType });\n  };\n\n  onTakeItem = item => {\n    this.setState(prevState => ({\n      toolbox: {\n        ...prevState.toolbox,\n        [prevState.currentBreakpoint]: prevState.toolbox[\n          prevState.currentBreakpoint\n        ].filter(({ i }) => i !== item.i)\n      },\n      layouts: {\n        ...prevState.layouts,\n        [prevState.currentBreakpoint]: [\n          ...prevState.layouts[prevState.currentBreakpoint],\n          item\n        ]\n      }\n    }));\n  };\n\n  onPutItem = item => {\n    this.setState(prevState => {\n      return {\n        toolbox: {\n          ...prevState.toolbox,\n          [prevState.currentBreakpoint]: [\n            ...(prevState.toolbox[prevState.currentBreakpoint] || []),\n            item\n          ]\n        },\n        layouts: {\n          ...prevState.layouts,\n          [prevState.currentBreakpoint]: prevState.layouts[\n            prevState.currentBreakpoint\n          ].filter(({ i }) => i !== item.i)\n        }\n      };\n    });\n  };\n\n  onLayoutChange = (layout, layouts) => {\n    saveToLS(\"layouts\", layouts);\n    \n    if (this.props.persist){\n        this.props.persist(layouts)\n    }\n    this.setState({ layouts });\n  };\n\n  onNewLayout = () => {\n    this.setState({\n      layouts: { lg: generateLayout() }\n    });\n  };\n\n  render() {\n    return (\n      <div>\n        \n        {/* <div>\n          Current Breakpoint: {this.state.currentBreakpoint} (\n          {this.props.cols[this.state.currentBreakpoint]} columns)\n        </div>\n        <div>\n          Compaction type:{\" \"}\n          {_.capitalize(this.state.compactType) || \"No Compaction\"}\n        </div>\n        <button onClick={this.onNewLayout}>Generate New Layout</button>\n        <button onClick={this.onCompactTypeChange}>\n          Change Compaction Type\n        </button>\n\n        <ToolBox\n          items={this.state.toolbox[this.state.currentBreakpoint] || []}\n          onTakeItem={this.onTakeItem}\n        /> */}\n\n        <ResponsiveReactGridLayout\n\n          {...this.props}\n          isDraggable={this.editingLayout}\n          layouts={this.state.layouts}\n          onBreakpointChange={this.onBreakpointChange}\n          onLayoutChange={this.onLayoutChange}\n          // WidthProvider option\n          measureBeforeMount={false}\n          // I like to have it animate on mount. If you don't, delete `useCSSTransforms` (it's default `true`)\n          // and set `measureBeforeMount={true}`.\n          useCSSTransforms={this.state.mounted}\n          compactType={this.state.compactType}\n          preventCollision={!this.state.compactType}\n        >\n          {this.generateDOM()}\n        </ResponsiveReactGridLayout>\n      </div>\n    );\n  }\n}\n\nfunction getFromLS(key) {\n    let ls = {};\n    if (global.localStorage) {\n      try {\n        ls = JSON.parse(global.localStorage.getItem(\"rgl-8\")) || {};\n      } catch (e) {\n        /*Ignore*/\n      }\n    }\n    return ls[key];\n  }\n  \n  function saveToLS(key, value) {\n    if (global.localStorage) {\n      global.localStorage.setItem(\n        \"rgl-8\",\n        JSON.stringify({\n          [key]: value\n        })\n      );\n    }\n  }\nfunction generateLayout() {\n    return _.map(_.range(0, 25), function(item, i) {\n      var y = Math.ceil(Math.random() * 4) + 1;\n      return {\n        x: (_.random(0, 5) * 2) % 12,\n        y: Math.floor(i / 6) * y,\n        w: 2,\n        h: y,\n        i: i.toString(),\n        static: Math.random() < 0.05\n      };\n    });\n  }\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nexport const Tags = props => {\n  if (props && props.references) {\n    return (<div className=\"tags\" style={{ display: \"flex\",flexWrap:\"wrap\" }}>\n      {props.references.map((group,key) => {\n        return <div key={key} style={{ padding: \"4px\", margin: \"4px\", backgroundColor: group.color, color: group.textColor }}>\n          {group.title}\n        </div>;\n      })}\n    </div>);\n  }\n  else {\n    return null;\n  }\n};\nTags.propTypes = {\n  references: PropTypes.array\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nexport const Highlight = props => {\n  \nif (!props.text) return null\nif (!props.filter) return  props.text\n\n    var ix = props.text.toLowerCase().indexOf(props.filter.toLowerCase())\n   if (ix===-1){\n     return props.text\n   }\n\n   \n   var first = props.text.substr(0,ix)\n   var middle = props.text.substr(ix,props.filter.length)\n   var last = props.text.substr(ix+props.filter.length)\n  return (\n    <>\n   \n      <span>{first}</span>\n      <span style={props.style}>{middle}</span>\n       <span>{last}</span>\n    \n    </>\n  );\n};\nHighlight.propTypes = {\n  style: PropTypes.object,\n\n  filter: PropTypes.string,\n  text: PropTypes.string\n};\n","import React, { useState } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Tags } from \"./Tags\";\nimport { Highlight } from \"./Highlight\";\nimport  \"./tile.css\"\nexport const AppSuperTile = props => {\n  var tile = props.tile ? props.tile : {};\n  const [html, setHtml] = useState(\"\");\n \n  return (<>\n\n  {props.tileSize===1 &&\n    <div className=\"supertile\" style={{border:\"0px dashed grey\",margin:10,maxWidth:\"300px\"}}>\n     \n     <div  style={{\n       \n       margin: 10,\n       padding: 10,\n       backgroundColor: tile.color,\n       color: tile.textcolor,\n       width: 300,\n       height: 70,\n       maxHeight: 70,\n       borderRadius:35,\n       overflow: \"hide\"\n       \n     }}>\n       <div style={{ cursor: \"pointer\" }} onClick={() => {\n         if (props.onClick){\n           props.onClick(tile);\n                }\n   \n       }}>\n         <div style={{display:\"flex\"}}>\n           \n         <div style={{  margin: 8, marginTop:8, height: 40 }}>\n           <img style={{ height: \"auto\", width: 40 }} src={tile.icon} />\n         </div>\n           <div title={tile.title} style={{flexGrow:1,height:\"40px\",width:\"300px\", overflow:\"hidden\",lineHeight:\"40px\",marginTop:\"6px\",marginLeft:\"4px\", fontSize:\"24px\"}}>\n           <Highlight text={tile.title} filter={props.filter} style={props.highlightStyle} /> \n           </div>\n          \n         <div style={{alignItems:\"flex-end\"}}>\n         <i\n                   style={{cursor:\"pointer\",display:\"none\"}}\n                     class={props.isPinned ? \"ms-Icon ms-Icon--PinnedFill\" : \"ms-Icon ms-Icon--Pinned\"}\n                     onClick={(e) => {\n                       if (props.onPinnedClicked){\n                         e.preventDefault()\n                         e.stopPropagation()\n                         props.onPinnedClicked(props)\n                       }\n                       \n                     }}\n                     aria-hidden=\"true\"\n                   ></i> \n         </div> </div>\n       \n         {/* <Tags references={tile.references} /> */}\n   \n       </div>\n     </div>\n     \n\n     </div>\n  }\n  {props.tileSize === 0 &&\n  <div style={{border:\"0px dashed grey\",margin:10,maxWidth:\"300px\"}}>\n     \n  <div style={{\n    margin: 10,\n    padding: 10,\n    backgroundColor: tile.color,\n    color: tile.textcolor,\n    width: 300,\n    height: 300,\n    maxHeight: 300,\n    overflow: \"auto\"\n  }}>\n    <div style={{ cursor: \"pointer\" }} onClick={() => {\n      if (props.onClick){\n        props.onClick(tile);\n             }\n\n    }}>\n      <div style={{display:\"flex\"}}><div style={{flexGrow:1}}><Highlight text={tile.title} filter={props.filter} style={props.highlightStyle} /> </div>\n      <div style={{alignItems:\"flex-end\"}}>\n      <i\n                style={{cursor:\"pointer\",display:\"none\"}}\n                  class={props.isPinned ? \"ms-Icon ms-Icon--PinnedFill\" : \"ms-Icon ms-Icon--Pinned\"}\n                  onClick={(e) => {\n                    if (props.onPinnedClicked){\n                      e.preventDefault()\n                      e.stopPropagation()\n                      props.onPinnedClicked(props)\n                    }\n                    \n                  }}\n                  aria-hidden=\"true\"\n                ></i> \n      </div>\n      </div>\n      \n      <div style={{ textAlign: \"center\", margin: 20, marginTop:40, height: 120 }}>\n        <img style={{ height: \"auto\", width: 112 }} src={tile.icon} />\n      </div>\n\n      <div style={{ maxHeight: 60, height: 60, overflow: \"auto\" }}>\n        {tile.inShort}\n      </div>\n       <Tags references={tile.references} /> \n\n    </div>\n  </div>\n  \n  <div style={{ display: \"flex\", justifyContent: \"flex-end\" }}>\n        {/* {tile.jumpto && (<a style={{ height: 24 }} className=\"button\" href={tile.jumpto} rel=\"noopener noreferrer\"  target=\"_blank\">\n          Jump to\n            </a>)} */}\n        {tile.externalArticle && (<a style={{ height: 24 }} className=\"button\" href={tile.externalArticle} rel=\"noopener noreferrer\"  target=\"_blank\">\n           More info\n            </a>)}\n      </div>\n  </div>\n  }\n  </>);\n};\nAppSuperTile.propTypes = {\n  tile: PropTypes.object,\n  onClose: PropTypes.func,\n  filter : PropTypes.string,\n  highlightStyle : PropTypes.object,\n  isPinned : PropTypes.bool,\n  onPinnedClicked:PropTypes.func,\n  tileSize:PropTypes.number\n};\n","import React, { useState, useEffect } from \"react\";\nimport axios from \"axios\";\nimport { QuillDeltaToHtmlConverter } from \"quill-delta-to-html\";\nimport PropTypes from \"prop-types\";\nimport { Tags } from \"./Tags\";\nexport const AppFullSizeTile = props => {\n  var tile = props.tile ? props.tile : {};\n  const [html, setHtml] = useState(\"\");\n  const [error, setError] = useState(null);\n  useEffect(() => {\n    if (tile.contentRef) {\n      axios\n        .get(tile.contentRef)\n        .then(result => {\n          var converter = new QuillDeltaToHtmlConverter(result.data.ops);\n          setHtml(converter.convert());\n        })\n        .catch(error => {\n          if (error.response.status !== 404) {\n            setError(error.message);\n          }\n        });\n    }\n  });\n  return (<>\n    {error && <div>{error}</div>}\n    <div onClick={props.onClose} style={{\n      backgroundColor: tile.color,\n      color: tile.textcolor,\n      width: \"100vw\",\n      height: \"100vh\",\n      \n      overflow: \"auto\"\n    }}>\n      <div>\n        <div style={{ display: \"flex\" }}>\n          <div style={{minWidth:\"10vw\"}}>\n            {\" \"}\n            <img style={{ margin: \"1vh\", height: \"auto\", width: \"10vw\" }} src={tile.icon} />\n          </div>\n          <div style={{ height: \"10vh\", width: \"auto\" }}>\n            <div className=\"fullSizeHeading\" style={{\n              padding: \"3vh\",\n              fontSize: \"5vh\",\n              textOverflow: \"nowrap\",\n              whiteSpace: \"no-wrap\"\n            }}>\n              {tile.title}\n            </div>\n            <div className=\"fullSizeDescription\" style={{ paddingLeft: \"3vh\", fontSize: \"3vh\" }}>\n              {tile.inShort}\n            </div>\n          </div>\n        </div>\n\n        <div style={{\n          height: \"80vh\",\n          overflow: \"auto\",\n          backgroundColor: \"#ffffff\",\n          color: \"#000000\",\n          padding: \"20px\"\n        }}>\n          <Tags references={tile.references} />\n          <div style={{ display: \"flex\", justifyContent: \"flex-end\" }}>\n        {tile.jumpto && (<a style={{ height: 24 }} className=\"button\" href={tile.jumpto} target=\"_blank\">\n          Jump to\n            </a>)}\n        {tile.externalArticle && (<a style={{ height: 24 }} className=\"button\" href={tile.externalArticle} target=\"_blank\">\n          Details\n            </a>)}\n      </div>\n          <div dangerouslySetInnerHTML={{ __html: html }}></div>\n        </div>\n        <div style={{ display: \"flex\", justifyContent: \"flex-end\" }}>\n          {tile.jumpto && (<a style={{ height: 24 }} className=\"button\" href={tile.jumpto} target=\"_blank\">\n            Jump to\n              </a>)}\n          {tile.externalArticle && (<a style={{ height: 24 }} className=\"button\" href={tile.externalArticle} target=\"_blank\">\n            Details\n              </a>)}\n        </div>\n      </div>\n    </div>\n  </>);\n};\nAppFullSizeTile.propTypes = {\n  tile: Object,\n  onClick: PropTypes.func\n};\n","/**\r\n * -------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\r\n * See License in the project root for license information.\r\n * -------------------------------------------------------------------------------------------\r\n */\r\n\r\n/**\r\n * @module ImplicitMSALAuthenticationProvider\r\n */\r\nimport { InteractionRequiredAuthError,UserAgentApplication } from \"msal\";\r\n/**\r\n * @class\r\n * Class representing ImplicitMSALAuthenticationProvider\r\n * @extends AuthenticationProvider\r\n */\r\n\r\nfunction inIframe() {\r\n   \r\n  try {\r\n    return window.self !== window.top;\r\n  } catch (e) {\r\n    return true;\r\n  }\r\n}\r\nexport class ImplicitMSALAuthenticationProvider {\r\n  /**\r\n   * @public\r\n   * @constructor\r\n   * Creates an instance of ImplicitMSALAuthenticationProvider\r\n   * @param {UserAgentApplication} msalApplication - An instance of MSAL UserAgentApplication\r\n   * @param {MSALAuthenticationProviderOptions} options - An instance of MSALAuthenticationProviderOptions\r\n   * @returns An instance of ImplicitMSALAuthenticationProvider\r\n   */\r\n  constructor(msalApplication, options) {\r\n    this.options = options;\r\n    this.msalApplication = msalApplication;\r\n  }\r\n  /**\r\n   * @public\r\n   * @async\r\n   * To get the access token\r\n   * @param {AuthenticationProviderOptions} authenticationProviderOptions - The authentication provider options object\r\n   * @returns The promise that resolves to an access token\r\n   */\r\n  getAccessToken(authenticationProviderOptions) {\r\n      var that = this\r\n    return new Promise(async (resolve, reject) => {\r\n      const options = authenticationProviderOptions;\r\n      let scopes;\r\n      if (typeof options !== \"undefined\") {\r\n        scopes = options.scopes;\r\n      }\r\n      if (typeof scopes === \"undefined\" || scopes.length === 0) {\r\n        scopes = this.options.scopes;\r\n      }\r\n      if (scopes.length === 0) {\r\n        const error = new Error();\r\n        error.name = \"EmptyScopes\";\r\n        error.message = \"Scopes cannot be empty, Please provide a scopes\";\r\n        throw error;\r\n      }\r\n\r\n      that.msalApplication.handleRedirectCallback((error, response) => {\r\n        debugger;\r\n        if (error) {\r\n          return reject(error);\r\n        }\r\n      });\r\n\r\n\r\n\r\n\r\n      if (this.msalApplication.getAccount()) {\r\n        const tokenRequest = {\r\n          scopes\r\n        };\r\n        try {\r\n          const authResponse = await this.msalApplication.acquireTokenSilent(\r\n            tokenRequest\r\n          );\r\n          resolve(authResponse.accessToken);\r\n        } catch (error) {\r\n          if (error instanceof InteractionRequiredAuthError) {\r\n            try {\r\n              if (inIframe()) {\r\n                const authResponse = await this.msalApplication.acquireTokenPopup(\r\n                  tokenRequest\r\n                );\r\n                resolve(authResponse.accessToken);\r\n              } else {\r\n                  debugger\r\n              }\r\n            } catch (error) {\r\n                debugger\r\n              reject(error);\r\n            }\r\n          } else {\r\n            debugger\r\n            reject(error);\r\n          }\r\n        }\r\n      } else {\r\n        try {\r\n          const tokenRequest = {\r\n            scopes\r\n          };\r\n          if (inIframe()) {\r\n            await this.msalApplication.loginPopup(tokenRequest);\r\n            const authResponse = await this.msalApplication.acquireTokenSilent(\r\n              tokenRequest\r\n            );\r\n            resolve(authResponse.accessToken);\r\n          } else {\r\n            \r\n           that.msalApplication.loginRedirect(tokenRequest);\r\n            return; // should have been redirected now\r\n          }\r\n        } catch (error) {\r\n            \r\n          reject(error);\r\n        }\r\n      }\r\n    });\r\n  }\r\n}\r\n","import * as Msal from \"msal\";\nimport { Client } from \"@microsoft/microsoft-graph-client\";\n\nimport { MSALAuthenticationProviderOptions } from \"@microsoft/microsoft-graph-client/lib/src/MSALAuthenticationProviderOptions\";\n\nimport { ImplicitMSALAuthenticationProvider } from \"./ImplicitMSALAuthenticationProvider\";\n//import { ImplicitMSALAuthenticationProvider } from \"@microsoft/microsoft-graph-client/lib/src/ImplicitMSALAuthenticationProvider\";\nimport axios from \"axios\";\n\n//import Excel from \"exceljs\"\nimport _ from \"lodash\";\nvar XLSX = require(\"xlsx\");\n// Configuration options for MSAL @see https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL.js-1.0.0-api-release#configuration-options\n// const msalConfig = {\n//     auth: {\n//         clientId: \"your_client_id\", // Client Id of the registered application\n//         redirectUri: \"your_redirect_uri\",\n//     },\n// };\nconst intoStream = require(\"into-stream\");\nconst graphScopes = [\n  \"User.Read.All\",\n  \"User.ReadWrite.All\",\n  \"mail.send\",\n  \"Files.ReadWrite.All\"\n]; // An array of graph scopes\n\n// // Important Note: This library implements loginPopup and acquireTokenPopup flow, remember this while initializing the msal\n// // Initialize the MSAL @see https://github.com/AzureAD/microsoft-authentication-library-for-js#1-instantiate-the-useragentapplication\n\nvar replyUrl =\n  window.location.protocol +\n  \"//\" +\n  window.location.hostname +\n  (window.location.port !== 80 &&\n  window.location.port !== 443 &&\n  window.location.port !== \"\"\n    ? \":\" + window.location.port\n    : \"\") +\n  window.location.pathname;\nvar msalConfig = {\n  auth: {\n    clientId: \"443ae28d-8cf8-42fd-ba63-f403ac085ead\",\n    redirectUri: replyUrl,\n    authority: \"https://login.microsoftonline.com/common\"\n  }\n};\nvar requestObj = {\n  scopes: graphScopes\n};\nvar msalInstance = new Msal.UserAgentApplication(msalConfig);\nmsalInstance.handleRedirectCallback((error, response) => {\n  // handle redirect response or error\n});\n\nconst msalApplication = new Msal.UserAgentApplication(msalConfig);\nconst authOptions = new MSALAuthenticationProviderOptions(graphScopes);\nconst authProvider = new ImplicitMSALAuthenticationProvider(\n  msalApplication,\n  authOptions\n);\nconst options = {\n  authProvider // An instance created from previous step\n};\n\nvar buffer = {\n  layouts: { pending: false }\n};\n\nfunction getClient() {\n  const MsClient = Client;\n  const client = MsClient.initWithMiddleware(options);\n  return client;\n}\n\nfunction get(path) {\n  return new Promise(async (resolve, reject) => {\n    const client = getClient();\n    try {\n      let data = await client.api(path).get();\n\n      return resolve(data);\n    } catch (error) {\n      return reject(error);\n    }\n  });\n}\nfunction me() {\n  return get(\"/me\");\n}\nfunction rootSite() {\n  return get(\"/sites/root\");\n}\n\nfunction initStorage() {\n  return new Promise(async (resolve, reject) => {\n    const client = getClient();\n    try {\n      let ztickyFolder = await client.api(\"/me/drive/root:/ZTICKYBAR\").get();\n      return resolve(ztickyFolder);\n    } catch (error) {\n      if (error.statusCode === 404) {\n        try {\n          const driveItem = {\n            name: \"ZTICKYBAR\",\n            folder: {},\n            \"@microsoft.graph.conflictBehavior\": \"rename\"\n          };\n\n          let ztickyFolder = await client\n            .api(\"/me/drive/root/children\")\n            .post(driveItem);\n\n          return resolve(ztickyFolder);\n        } catch (error) {\n          return reject(error);\n        }\n      } else {\n        return reject(error);\n      }\n    }\n  });\n}\nfunction initTileStorage() {\n  return new Promise(async (resolve, reject) => {\n    const client = getClient();\n    try {\n      let ztickyFolder = await client\n        .api(\"/me/drive/root:/ZTICKYBAR/tiles\")\n        .get();\n      return resolve(ztickyFolder);\n    } catch (error) {\n      if (error.statusCode === 404) {\n        try {\n          const driveItem = {\n            name: \"tiles\",\n            folder: {},\n            \"@microsoft.graph.conflictBehavior\": \"rename\"\n          };\n\n          let ztickyFolder = await client\n            .api(\"/me/drive/root:/ZTICKYBAR:/children\")\n            .post(driveItem);\n\n          return resolve(ztickyFolder);\n        } catch (error) {\n          return reject(error);\n        }\n      } else {\n        return reject(error);\n      }\n    }\n  });\n}\nfunction getMyTools(ztickyFolder, refresh) {\n  return new Promise(async (resolve, reject) => {\n    try {\n      if (!refresh) {\n        var cache = localStorage.getItem(\"mytools\");\n        if (cache) {\n          return resolve(JSON.parse(cache));\n        }\n      }\n      const client = getClient();\n      let folders = await client\n        .api(`/me/drive/items/${ztickyFolder.id}/children`)\n        .get();\n\n      var queueLength = 0;\n\n      if (folders.value.length === 0) return resolve(folders.value);\n\n      folders.value.forEach(async folder => {\n        queueLength++;\n        folder.tile = await getMyTool(folder);\n\n        queueLength--;\n        if (queueLength === 0) {\n          localStorage.setItem(\"mytools\", JSON.stringify(folders.value));\n          return resolve(folders.value);\n        }\n      });\n    } catch (error) {\n      reject(error);\n    }\n  });\n}\n\nfunction getTileXLSX(toolFolder) {\n  return new Promise(async (resolve, reject) => {\n    try {\n      const client = getClient();\n\n      let tile = await client\n        .api(`/me/drive/items/${toolFolder.id}:/tile.xlsx:`)\n        .get();\n\n      axios({\n        url: tile[\"@microsoft.graph.downloadUrl\"],\n        method: \"GET\",\n        responseType: \"arraybuffer\"\n      }).then(response => {\n        var wb = XLSX.read(response.data, { type: \"buffer\" });\n\n        if (!wb.Sheets.ZTICKYBAR) return resolve(null);\n        var rows = XLSX.utils.sheet_to_json(wb.Sheets.ZTICKYBAR, {\n          header: 1,\n          raw: false\n        });\n\n        var data = {};\n        rows.forEach(row => {\n          data[row[0]] = row[1];\n        });\n\n        resolve(data);\n      });\n    } catch (error) {\n      debugger;\n      resolve(null);\n    }\n  });\n}\n\nfunction getFile(folder, filename) {\n  return new Promise(async (resolve, reject) => {\n    try {\n      const client = getClient();\n\n      let tile = await client\n        .api(`/me/drive/items/${folder.id}:/${filename}:`)\n        .get();\n      axios.get(tile[\"@microsoft.graph.downloadUrl\"]).then(response => {\n        resolve(response.data);\n      });\n    } catch (error) {\n      resolve(null);\n    }\n  });\n}\nfunction getMyTool(toolFolder) {\n  return new Promise(async (resolve, reject) => {\n    try {\n      var tileData = await getTileXLSX(toolFolder);\n      if (tileData) {\n        return resolve(tileData);\n      }\n      resolve({});\n      // const client = getClient();\n\n      // let tile = await client\n      //   .api(`/me/drive/items/${toolFolder.id}:/tile.json:`)\n      //   .get();\n      // axios.get(tile[\"@microsoft.graph.downloadUrl\"]).then(response => {\n      //   resolve(response.data);\n      // });\n    } catch (error) {\n      reject(error);\n    }\n  });\n}\nfunction addTile(ztickyFolder, tile) {\n  return new Promise(async (resolve, reject) => {\n    const client = getClient();\n    try {\n      var folderName = tile.tableId\n        ? tile.title + \" (\" + tile.tableId.replace(\"/\", \"-\") + \")\"\n        : tile.title;\n      const driveItem = {\n        name: folderName,\n        folder: {},\n        \"@microsoft.graph.conflictBehavior\": \"replace\"\n      };\n\n      let folder = await client\n        .api(`/me/drive/items/${ztickyFolder.id}/children`)\n        .post(driveItem);\n\n      // let file = await client\n      //   .api(`/me/drive/items/${folder.id}:/tile.json:/content`)\n      //   .put(tile);\n\n      var props = _.keys(tile);\n      var data = [];\n      props.forEach(prop => {\n        if (prop === \"references\") return;\n        data.push([prop, tile[prop]]);\n      });\n      var workbook = XLSX.utils.book_new();\n\n      var ws = XLSX.utils.aoa_to_sheet(data);\n      XLSX.utils.book_append_sheet(workbook, ws, \"ZTICKYBAR\");\n      var wopts = { bookType: \"xlsx\", bookSST: false, type: \"array\" };\n\n      var wbout = XLSX.write(workbook, wopts);\n\n      var x = await client\n        .api(`/me/drive/items/${folder.id}:/tile.xlsx:/content`)\n\n        .put(wbout);\n\n      // axios\n      //   .request({\n      //     responseType: \"arraybuffer\",\n      //     url: tile.icon,\n      //     method: \"get\"\n      //   })\n      //   .then(async response => {\n      //     await client\n      //       .api(`/me/drive/items/${folder.id}:/image.png:/content`)\n      //       .put(response.data);\n      //   })\n      //   .catch(error => {\n      //     // debugger;\n      //   });\n      folder.tile = tile;\n      return resolve(folder);\n    } catch (error) {\n      debugger;\n      return reject(error);\n    }\n  });\n}\n\nfunction blobToBase64(blob) {\n  return new Promise((resolve, reject) => {\n    try {\n      var blobUrl = URL.createObjectURL(blob);\n\n      var xhr = new XMLHttpRequest();\n      xhr.responseType = \"blob\";\n\n      xhr.onload = function() {\n        var recoveredBlob = xhr.response;\n\n        var reader = new FileReader();\n\n        reader.onload = function() {\n          var blobAsDataUrl = reader.result;\n          resolve(blobAsDataUrl);\n        };\n\n        reader.readAsDataURL(recoveredBlob);\n      };\n\n      xhr.open(\"GET\", blobUrl);\n      xhr.send();\n    } catch (error) {\n      debugger;\n      resolve(null);\n    }\n  });\n}\n\nfunction teamMemberships() {\n  return new Promise(async (resolve, reject) => {\n    var groups = [];\n\n    try {\n      const client = getClient();\n\n      client\n        .api(\"/me/joinedTeams\")\n        // .version('beta')\n        .get(async (error, memberships) => {\n          if (error) {\n            return reject(error);\n          }\n          var pending = 0;\n          memberships.value.map(async value => {\n            pending++;\n\n            try {\n              var photo = await client\n                .api(`/groups/${value.id}/photo/$value`)\n                .get();\n\n              var base64 = await blobToBase64(photo);\n            } catch (error) {}\n\n            var details = await client\n              .api(`/teams/${value.id}`)\n              //.version(\"beta\")\n              .get();\n\n            var channels = await client\n              .api(`/teams/${value.id}/channels`)\n              .version(\"beta\")\n              .get();\n\n            groups.push({\n              key: value.id,\n              text: value.displayName,\n              title: value.description,\n\n              data: {\n                details,\n                photo: base64,\n                channels: channels.value\n              }\n            });\n\n            pending--;\n            if (pending === 0) {\n              return resolve(\n                groups.sort((a, b) => {\n                  if (a.text < b.text) {\n                    return -1;\n                  }\n                  if (a.text > b.text) {\n                    return 1;\n                  }\n                  return 0;\n                })\n              );\n            }\n          });\n        });\n    } catch (error) {\n      return reject(error);\n    }\n  });\n}\n\nfunction delaywriteLayouts() {\n  setTimeout(() => {\n    console.log(\"delaywriteLayouts\");\n    if (!buffer.layouts.pending) {\n      return;\n    }\n    if (buffer.layouts.writing) {\n      return delaywriteLayouts();\n    }\n    writeLayouts(buffer.layouts.folder, buffer.layouts.data);\n  }, 500);\n}\n\nconst LAYOUTSJSON = \"layouts.json\";\nfunction writeLayouts(folder, layouts, properties, useLocalStorage) {\n  var data = { version: 1, layouts, properties };\n\n  return new Promise(async (resolve, reject) => {\n    console.log(\"writeLayouts\");\n    if (buffer && buffer.layouts && buffer.layouts.writing) {\n      if (_.isEqual(buffer.layouts.data, data)) {\n        console.log(\"writeLayouts no changes\");\n        return resolve();\n      }\n      buffer.layouts.pending = true;\n      buffer.layouts.data = data;\n      buffer.layouts.folder = folder;\n      delaywriteLayouts();\n      return resolve();\n    }\n\n    try {\n      if (useLocalStorage) {\n        localStorage.setItem(LAYOUTSJSON, JSON.stringify(data));\n        return resolve();\n      }\n      buffer.layouts.writing = true;\n      buffer.layouts.current = data;\n      const client = getClient();\n      console.log(\"writeLayouts > got Client\");\n      await client\n        .api(`/me/drive/items/${folder.id}:/layouts.json:/content`)\n        .put(data);\n      console.log(\"writeLayouts > wrote\");\n\n      resolve();\n    } catch (error) {\n      console.log(\"writeLayouts > error\", error);\n      return reject(error);\n    } finally {\n      buffer.layouts.writing = false;\n    }\n  });\n}\nfunction readLayouts(ztickyFolder, useLocalStorage) {\n  return new Promise(async (resolve, reject) => {\n    if (useLocalStorage) {\n      var layouts = localStorage.getItem(LAYOUTSJSON);\n      if (!layouts) {\n        return resolve(null);\n      }\n      try {\n        var data = JSON.parse(layouts);\n        return resolve([data.layouts, data.properties, data.version]);\n      } catch (error) {\n        console.log(\"error parsing local storagee layouts\", error);\n        return resolve(null);\n      }\n    }\n    var data = await getFile(ztickyFolder, \"layouts.json\");\n    if (data) {\n      resolve([data.layouts, data.properties, data.version]);\n    } else {\n      const emptyResult = [{ lg: [] }, {}, -1];\n      resolve(emptyResult);\n    }\n\n    try {\n    } catch (error) {\n      resolve(null);\n    }\n  });\n}\nexport default {\n  me,\n  rootSite,\n  initStorage,\n  initTileStorage,\n  addTile,\n  getMyTools,\n  teamMemberships,\n  writeLayouts,\n  readLayouts\n};\n\n// var PTO365 = {\n//   user: msalInstance.getAccount()\n// };\n// if (!PTO365.user) {\n//   msalInstance.loginRedirect(requestObj);\n// }\n// console.log(\"User account\", PTO365.user);\n","import React from \"react\";\nimport logo from \"./nets/logo_intranets.png\";\nimport {\n  Dropdown,\n  DropdownMenuItemType,\n  IDropdownStyles,\n  IDropdownOption\n} from \"office-ui-fabric-react/lib/Dropdown\";\n\nexport default {\n  clientId: \"\",\n  scopes: [\"user.read\"],\n  title: \"Tools\",\n  logo,\n  options: [\n    {\n      key: \"fruitsHeader\",\n      text: \"Nets Group\",\n      itemType: DropdownMenuItemType.Header\n    },\n    {\n      key: {\n        id: \"nets.eu/2019-q4\",\n        api:\n          \"https://api.jumpto365.com/table/nets.eu/2019-q4\",\n        web: \"https://pro.jumpto365.com/@/nets.eu/2019-q4\"\n      },\n      text: \"One Tenant - Wave 1\"\n    },\n    {\n      key: {\n        id: \"nets.eu/digital-workplace\",\n        api:\n          \"https://api.jumpto365.com/table/nets.eu/digital-workplace\",\n        web:\n          \"https://pro.jumpto365.com/@/nets.eu/digital-workplace\"\n      },\n      text: \"Digital Workplace\"\n    },\n    {\n      key: {\n        id: \"nets.eu/group-tech-highlevel\",\n        api:\n          \"https://api.jumpto365.com/table/nets.eu/group-tech-highlevel\",\n        web:\n          \"https://pro.jumpto365.com/@/nets.eu/group-tech-highlevel\"\n      },\n      text: \"Group Tech Playbook\"\n    },\n\n    {\n      key: \"divider_1\",\n      text: \"-\",\n      itemType: DropdownMenuItemType.Divider\n    },\n    {\n      key: \"jumpto365\",\n      text: \"Generic Periodic Tables\",\n      itemType: DropdownMenuItemType.Header\n    },\n    {\n      key: {\n        id: \"hexatown.com/PTO365\",\n        api:\n          \"https://api.jumpto365.com/table/hexatown.com/PTO365\",\n        web:\n          \"https://pro.jumpto365.com/@/hexatown.com/PTO365\"\n      },\n      text: \"Office 365\"\n    },\n    {\n      key: {\n        id: \"jumpto365.com/ems5\",\n        api:\n          \"https://api.jumpto365.com/table/jumpto365.com/ems5\",\n        web:\n          \"https://pro.jumpto365.com/@/jumpto365.com/ems5\"\n      },\n      text: \"EMS\"\n    }\n    //{ key: 'https://raw.githubusercontent.com/hexatown/docs/master/contexts/ai/index.json', text: 'AI' }\n  ],\n  components: {\n    header: (\n      <div style={{ borderBottom: \"1px solid #cccccc\" }}>\n        <div style={{ display: \"flex\", margin: \"20px\" }}>\n          <div style={{flexGrow:1}}><a href=\"https://nets-intranets.com\" target=\"_blank\">\n            <img style={{ height: \"32px\", padding: \"4px\" }} src={logo} /></a>\n          </div>\n          <div\n            style={{\n              \n              marginLeft: \"16px\",\n              fontSize: \"18px\",\n              lineHeight: \"32px\",\n              padding: \"0px\",\n              color:\"333\"\n              \n            }}\n          \n>\n            \n          </div>\n        </div>\n      </div>\n    )\n  }\n};\n","/* \nTool Catalogue\n\nCopyright (c) jumpto365, Inc\n\nAll rights reserved.\n\nMIT License\n\nPermission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"\"Software\"\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED *AS IS*, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n * \n * Written by Niels Gregers Johansen <niels@jumpto365.com>, December 2019\n */\nimport React, { Component, useState, useEffect } from \"react\";\nimport { getSearchParametersFromHRef } from \"./helpers\";\nimport \"./App.css\";\nimport \"./css/normalize.css\";\nimport \"./css/webflow.css\";\nimport \"./css/swimlane-process-map.webflow.css\";\nimport axios from \"axios\";\nimport _ from \"lodash\";\n\nimport { AppSuperTile } from \"./components/AppSuperTile\";\nimport { AppFullSizeTile } from \"./components/AppFullSizeTile\";\nimport { TextField } from \"office-ui-fabric-react/lib/TextField\";\nimport { initializeIcons } from \"@uifabric/icons\";\n\nimport OfficeGraph from \"./helpers/OfficeGraph\";\nimport { PivotItem, Pivot } from \"office-ui-fabric-react/lib/Pivot\";\nimport { ViewErrors } from \"./components/ViewErrors\";\nimport { ViewTeams } from \"./components/ViewTeams\";\nimport {\n  DefaultButton,\n  PrimaryButton,\n  Stack,\n  IStackTokens,\n  ShimmerElementsGroup\n} from \"office-ui-fabric-react\";\nimport {\n  Dropdown,\n  DropdownMenuItemType,\n  IDropdownStyles,\n  IDropdownOption\n} from \"office-ui-fabric-react/lib/Dropdown\";\nimport { ProgressIndicator } from \"office-ui-fabric-react/lib/ProgressIndicator\";\nimport { Toggle } from \"office-ui-fabric-react/lib/Toggle\";\nimport {\n  CommandBar,\n  ICommandBarItemProps\n} from \"office-ui-fabric-react/lib/CommandBar\";\n\nimport Animejs from \"animejs\";\nimport \"react-grid-layout/css/styles.css\";\nimport \"react-resizable/css/styles.css\";\nimport GridLayout from \"react-grid-layout\";\nimport ToolboxLayout from \"./components/ToolboxLayout\";\nimport { ErrorCacheKeys } from \"msal/lib-commonjs/utils/Constants\";\n\nimport config from \"./config\"\nfunction inIframe() {\n  try {\n    return window.self !== window.top;\n  } catch (e) {\n    return true;\n  }\n}\ninitializeIcons();\n\nexport default function App() {\n  const [titlegraphics, setTitlegraphics] = useState(\"\");\n  const [filter, setFilter] = useState(\"\");\n  const [tiles, setTiles] = useState([]);\n  const [useAuthentication, setUseAuthentication] = useState(false);\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n  const [isZoomed, setIsZoomed] = useState(false);\n  const [currentTile, setCurrentTile] = useState(null);\n  const [me, setMe] = useState({});\n  const [ztickyFolder, setZtickyFolder] = useState({});\n  const [myTools, setMyTools] = useState([]);\n  const [ztickyRef, setZtickyRef] = useState(\"\");\n  const [tileSize, setTileSize] = useState(1);\n  const [errors, setErrors] = useState([]);\n  const [memberships, setMemberships] = useState([]);\n  const [siteUrlLabel, setSiteUrlLabel] = useState(\"\");\n  const [siteUrlHref, setSiteUrlHref] = useState(\"\");\n  const [refreshing, setRefresing] = useState(false);\n  const [progress, setProgress] = useState(\"\");\n  const [showTable, setShowTable] = useState(false);\n  const [editingLayout, setEditingLayout] = useState(true);\n  const [showFilterOptions, setShowFilterOptions] = useState(false);\n  const [tableUrl, setTableUrl] = useState(\"\");\n  const [layouts, setLayouts] = useState({});\n  const [currentPivot, setCurrentPivot] = useState(\"pinned\");\n  const [tableApiSelected, setTableApiSelected] = useState(\n    \"https://api.jumpto365.com/table/jumpto365.com/APAC%20DIGITAL%20WORKPLACE\"\n  );\n  const [selectedGroup, setSelectedGroup] = useState(\"\");\n  const [groups, setGroups] = useState([]);\n  const inFrame = inIframe();\n  const addTile = tile => {\n    setProgress(\"Adding pin\");\n    OfficeGraph.addTile(ztickyFolder, tile)\n      .then(async folder => {\n        try {\n          // var myTools = await OfficeGraph.getMyTools(ztickyFolder, true);\n          myTools.push(folder);\n\n          var keys = _.keys(layouts);\n          keys.forEach(key => {\n            layouts[key].push({\n              x: 0,\n              y: Infinity,\n              w: 3,\n              h: 3,\n\n              i: layouts[key].length.toString(),\n\n              static: 0 //Math.random() < 0.05,\n            });\n          });\n          setLayouts(layouts);\n\n          //\n          setMyTools(myTools);\n        } catch (error) {\n          errors.push({ context: \"AddTile > myTools.push() \", error });\n          setErrors(errors);\n        }\n        // myTools.forEach(tool=>{\n\n        // })\n        // debugger\n      })\n      .catch(error => {\n        errors.push({ context: \"OfficeGraph.addTile()\", error });\n        setErrors(errors);\n      })\n      .finally(() => {\n        setProgress(\"\");\n      });\n    // db.table('myTiles')\n    //   .add(tile)\n    //   .then((id) => {\n    //     const newList = [...myTiles, Object.assign({}, tile, { id })];\n    //     setMyTiles(newList)\n    //   });\n  };\n\n  useEffect(() => {\n    // db.table(\"myTiles\").toArray().then(tiles=>{setMyTiles(tiles)})\n    \n    if (useAuthentication) {\n      initGraph();\n      OfficeGraph.me()\n        .then(userDetails => {\n          setMe(userDetails);\n          window.document.title = userDetails.displayName + \" Tools\";\n        })\n        .catch(error => {\n          errors.push({ context: \"OfficeGraph.me()\", error });\n          setErrors(errors);\n        });\n    }\n    var search = getSearchParametersFromHRef(window.location.href);\n    if (search.ztickyref) {\n      setZtickyRef(search.ztickyref);\n    }\n    var href = search.src\n      ? search.src\n      : config.defaultTableAPI;\n    setTableUrl(config.defaultTableAPI);\n    readGrid(href,config.defaultTableKey);\n  }, []);\n\n  function readGrid(href, tableId) {\n    axios.get(href).then(({ data }) => {\n      setTitlegraphics(data.titlegraphics);\n      var tiles = [];\n      if (data.grid) {\n        var groups = {};\n        var groupRefs = {};\n        data.grid.forEach(row => {\n          return row.forEach(cell => {\n            if (cell.groupSetting) {\n              groups[cell.groupSetting.title] = {\n                groupSetting: cell.groupSetting,\n                members: cell.members\n              };\n              if (cell.members) {\n                cell.members.forEach(id => {\n                  var refs = groupRefs[id] ? groupRefs[id] : [];\n                  refs.push(cell.groupSetting);\n                  groupRefs[id] = refs;\n                });\n              }\n            }\n          });\n        });\n\n        var g = _.keys(groups);\n        var ga = g.map(name => {\n          return { title: name, ...groups[name] };\n        });\n\n        setGroups(_.sortBy(ga, [\"title\"]))\n\n       \n        data.grid.forEach(row => {\n          return row.forEach(cell => {\n            if (cell.tile && cell.tile.title) {\n              var tile = { ...cell.tile };\n              tile.tableId = tableId;\n              tile.correlation =\n                href +\n                \"#\" +\n                (tile.key\n                  ? tile.key\n                  : tile.title\n                  ? tile.title.toLowerCase()\n                  : tile.id);\n              var references = groupRefs[cell.id];\n              tile.references = references;\n              tiles.push(tile);\n            }\n          });\n        });\n      }\n      setTiles(_.sortBy(tiles, [\"title\", \"href\"]));\n    });\n  }\n\n  async function initGraph(refresh) {\n    try {\n      if (refresh) {\n        localStorage.removeItem(\"memberships\");\n        localStorage.removeItem(\"mytools\");\n      }\n      var queueCount = 0;\n\n      setRefresing(true);\n\n      await OfficeGraph.initStorage();\n\n      // var cachedMemberships = localStorage.getItem(\"memberships\");\n      // if (cachedMemberships && !refresh) {\n      //   setMemberships(JSON.parse(cachedMemberships));\n      // } else {\n      //   queueCount ++\n      //   OfficeGraph.teamMemberships()\n      //     .then(memberships => {\n      //       localStorage.setItem(\"memberships\", JSON.stringify(memberships));\n      //       queueCount --\n      //       if (queueCount===0) setRefresing(false)\n      //       setMemberships(memberships);\n      //     })\n      //     .catch(error => {\n      //       queueCount --\n      //       if (queueCount<=0) setRefresing(false)\n      //       errors.push({ context: \"OfficeGraph.teamMemberships()\", error });\n      //       setErrors(errors);\n      //     });\n      // }\n\n      OfficeGraph.initTileStorage()\n        .then(async ztickyFolder => {\n          setZtickyFolder(ztickyFolder);\n          queueCount++;\n\n          var [layouts, properties, version] = await OfficeGraph.readLayouts(\n            ztickyFolder\n          );\n          //debugger\n          var myTools = [];\n          if (version < 0) {\n            var tileFolders = await OfficeGraph.getMyTools(\n              ztickyFolder,\n              refresh\n            );\n            myTools = tileFolders.map(folder => {\n              return {\n                title: folder.tile ? folder.tile.title : folder.name,\n                tile: folder.tile\n              };\n            });\n          } else {\n            myTools = properties.tiles.map(tile => {\n              if (!tile) return null;\n\n              return { title: tile.title, tile };\n            });\n          }\n\n          queueCount--;\n          if (queueCount === 0) setRefresing(false);\n          setMyTools(myTools);\n          setLayouts(layouts);\n        })\n        .catch(error => {\n          queueCount--;\n          if (queueCount <= 0) setRefresing(false);\n          errors.push({ context: \"OfficeGraph.initStorage()\", error });\n          setErrors(errors);\n        });\n    } catch (error) {\n      errors.push({ context: \"initGraph\", error });\n      setErrors(errors);\n    }\n  }\n\n  function matchFilter(tile) {\n    var match =\n      tile &&\n      tile.title &&\n      tile.title.toLowerCase().indexOf(filter.toLowerCase()) !== -1;\n    if (!match)\n      match =\n        tile &&\n        tile.inShort &&\n        tile.inShort.toLowerCase().indexOf(filter.toLowerCase()) !== -1;\n    if (!match)\n      match =\n        tile &&\n        tile.subTitle &&\n        tile.subTitle.toLowerCase().indexOf(filter.toLowerCase()) !== -1;\n\n    return match;\n  }\n\n  function matchTeam(team) {\n    var details = team.data && team.data.details ? team.data.details : {};\n    var channels = team.data && team.data.channels ? team.data.channels : [];\n    var match =\n      details.displayName &&\n      details.displayName.toLowerCase().indexOf(filter.toLowerCase()) !== -1;\n    if (!match)\n      match =\n        details.description &&\n        details.description.toLowerCase().indexOf(filter.toLowerCase()) !== -1;\n    channels.forEach(channel => {\n      if (!match) {\n        match =\n          channel.displayName &&\n          channel.displayName.toLowerCase().indexOf(filter.toLowerCase()) !==\n            -1;\n      }\n      if (!match) {\n        match =\n          channel.description &&\n          channel.description.toLowerCase().indexOf(filter.toLowerCase()) !==\n            -1;\n      }\n    });\n\n    return match;\n  }\n  function persistLayouts(layouts) {\n    setLayouts(layouts);\n    var tiles = myTools.map(tool => {\n      return tool.tile;\n    });\n    OfficeGraph.writeLayouts(ztickyFolder, layouts, { tiles })\n      .then()\n      .catch(error => {\n        errors.push({ context: \"  OfficeGraph.writeLayouts()\", error });\n        setErrors(errors);\n      });\n  }\n\n  var filteredTiles = !filter ? tiles : [];\n  var filteredMyTools = !filter ? myTools : [];\n  var filteredMemberShips = !filter ? memberships : [];\n  var filteredSiteLinks = !filter ? [] : [];\n  var siteUrl = ztickyRef ? new URL(ztickyRef) : null;\n  if (filter) {\n    tiles.forEach(tile => {\n      if (matchFilter(tile)) {\n        filteredTiles.push(tile);\n      }\n    });\n    myTools.forEach(folder => {\n      if (matchFilter(folder.tile)) {\n        filteredMyTools.push(folder);\n      }\n    });\n\n    memberships.forEach(team => {\n      if (matchTeam(team)) {\n        filteredMemberShips.push(team);\n      }\n    });\n  }\n\n  const dropdownStyles = {\n    dropdown: { width: 300 }\n  };\n  return (\n    <div>\n            {!inFrame && (\n config.components.header\n      )}\n      {/* <CommandBar\n        // items={_items}\n        // overflowItems={_overflowItems}\n        // overflowButtonProps={overflowProps}\n        farItems={[\n          // {\n          //   key: \"tile\",\n          //   text: \"Grid view\",\n          //   // This needs an ariaLabel since it's icon-only\n          //   ariaLabel: \"Filter view\",\n          //   iconOnly: true,\n          //   iconProps: { iconName: \"Filter\" },\n          //   onClick: () => {\n          //     if (showFilterOptions) {\n          //       setFilter(\"\");\n          //     }\n          //     setShowFilterOptions(!showFilterOptions);\n          //   }\n          // }\n        ]}\n        ariaLabel=\"Use left and right arrow keys to navigate between commands\"\n      /> */}\n      <div style={{ paddingRight: \"20px\", paddingLeft: \"20px\" }}>\n        {\" \"}\n        {progress && (\n          <div\n            style={{\n              backgroundColor: \"white\",\n              width: \"100vw\",\n              position: \"fixed\",\n              top: \"0px\"\n            }}\n          >\n            <ProgressIndicator xlabel=\"Example title\" description={progress} />\n          </div>\n        )}\n        <img\n          style={{\n            display: \"none\",\n            height: \"64px\",\n            margin: \"13px\",\n            position: \"fixed\",\n            bottom: \"0px\",\n            right: \"0px\"\n          }}\n          src={titlegraphics}\n        ></img>\n        {isZoomed && (\n          <div>\n            <AppFullSizeTile\n              tile={currentTile ? currentTile : tiles ? tiles[0] : null}\n              onClose={() => {\n                setIsZoomed(false);\n              }}\n            />\n          </div>\n        )}\n        {!isZoomed && (\n          <div style={{ display: \"flex\" }}>\n            {\" \"}\n            <div\n              style={{\n                display: \"none\",\n                paddingRight: \"8px\",\n                position: \"fixed\",\n                bottom: \"0px\",\n                backgroundColor: \"white\"\n              }}\n            >\n              <a href={ztickyFolder.webUrl} target=\"_blank\">\n                <i\n                  style={{\n                    cursor: \"pointer\",\n                    padding: \"4px\",\n                    color: \"black\"\n                  }}\n                  class=\"ms-Icon ms-Icon--OpenFolderHorizontal\"\n                  aria-hidden=\"true\"\n                ></i>{\" \"}\n              </a>\n              <i\n                style={{ cursor: \"pointer\", padding: \"4px\" }}\n                class=\"ms-Icon ms-Icon--Refresh\"\n                onClick={() => {\n                  initGraph(true);\n                }}\n                aria-hidden=\"true\"\n              ></i>{\" \"}\n              {refreshing && <>Loading</>}\n            </div>\n            <div\n              style={{\n                position: \"fixed\",\n                right: 0,\n                top: 0,\n                zIndex: 32,\n                marginRight: \"16px\"\n              }}\n            >\n              {/* <div style={{ display: \"flex\" }}>\n                <div style={{ padding: \"8px\", marginTop: \"0px\" }}>\n                  Table view\n                </div>\n                <div style={{ marginTop: \"8px\" }}>\n                  <Toggle\n                    xlabel=\"Show Table\"\n                    checked={showTable}\n                    xonText=\"Table view On\"\n                    xoffText=\"Table view Off\"\n                    onChange={(e, checked) => {\n                      setShowTable(checked);\n                    }}\n                  />\n                </div>\n              </div> */}\n            </div>\n            <div style={{ flexGrow: \"1\" }}>\n              {/* <Pivot\n                style={{ padding: \"0px\" }}\n                selectedKey={currentPivot}\n                onLinkClick={(e, pivot, x) => {\n                  // debugger\n                  // setCurrentPivot(pivot.key)\n                }}\n              > */}\n                {filteredMyTools.length > 0 && (\n                  // <PivotItem\n                  //   key=\"pinned\"\n                  //   headerText=\"Pinned\"\n                  //   itemCount={filteredMyTools.length}\n                  // >\n                    <div>\n                      <div style={{ display: \"flex\", flexWrap: \"wrap\" }}>\n                        {filteredMyTools.map((folder, key) => {\n                          var tile = folder.tile\n                            ? folder.tile\n                            : {\n                                title: folder.name,\n                                color: \"#dddddd\"\n                              };\n                          return (\n                            <AppSuperTile\n                              tileSize={tileSize}\n                              isPinned={true}\n                              key={key}\n                              tile={tile}\n                              filter={filter}\n                              highlightStyle={{\n                                backgroundColor: \"yellow\",\n                                color: \"#333\"\n                              }}\n                              onClick={tile => {\n                                // addTile(tile)\n\n                                if (tile.jumpto) {\n                                  return window.open(tile.jumpto, \"_blank\");\n                                }\n                                setCurrentTile(tile);\n                                setIsZoomed(true);\n                              }}\n                            />\n                          );\n                        })}\n                      </div>\n                    </div>\n                  // </PivotItem>\n                )}\n                {/* {siteUrl && (\n                  <PivotItem\n                    headerText=\"Site\"\n                    itemCount={filteredSiteLinks.length}\n                  >\n                    <h3>Which tools do you find good for this site?</h3>\n                    <div>{siteUrl.hostname}</div>\n                    <TextField\n                      label=\"Label\"\n                      placeholder=\"Enter label for this link\"\n                      value={siteUrlLabel}\n                      onChange={(e, value) => {\n                        setSiteUrlLabel(value);\n                      }}\n                    ></TextField>\n                    <TextField\n                      label=\"URL\"\n                      placeholder=\"Enter URL\"\n                      value={siteUrlHref}\n                      onChange={(e, value) => {\n                        setSiteUrlHref(value);\n                      }}\n                    ></TextField>\n                    <PrimaryButton\n                      text=\"Share link\"\n                      disabled={!siteUrlHref && !siteUrlLabel ? true : false}\n                    />\n                  </PivotItem>\n                )} */}\n                {/* <PivotItem\n                  key=\"catalogue\"\n                  headerText=\"Catalogue\"\n                  itemCount={filteredTiles.length}\n                > */}\n                  <div\n                    style={{\n                      display: \"flex\",\n                      flexWrap: \"wrap\",\n                      marginTop: \"8px\"\n                    }}\n                  >\n                                        <div\n                      style={{ padding: \"0px\", marginLeft: \"8px\", flexGrow: 1 }}\n                    >\n                      <TextField\n                        disabled={showTable}\n                        \n                        xlabel=\"Filter\"\n                        value={filter}\n                        onChange={(e, newValue) => {\n                          setFilter(newValue);\n                        }}\n                        placeholder=\"Start typing any characters to filter the list of tools\"\n                        iconProps={{ iconName: \"Filter\" }}\n                      />\n                    </div>{\" \"}\n                    {/* <div style={{ marginLeft: \"16px\", flexGrow: 0 }}>\n                      <Dropdown\n                        placeholder=\"Select an area\"\n                        label=\"Area\"\n                        onChanged={(option, index) => {\n                          readGrid(option.key.api, option.key.id);\n                          setTableUrl(option.key.web);\n                          setTableApiSelected(option.key.api);\n                          setSelectedGroup(\"\");\n                          //debugger\n                        }}\n                        xxselectedKey={tableApiSelected} //\"\"\n                        options={config.options}\n                        styles={dropdownStyles}\n                      />\n                    </div>\n                    <div style={{ marginLeft: \"16px\", flexGrow: 0 }}>\n                      <Dropdown\n                        placeholder=\"Select a group\"\n                        label=\"Group\"\n                        onChanged={(option, index) => {\n                          setSelectedGroup(option.key);\n                        }}\n                        selectedKey={selectedGroup}\n                        options={groups ? groups.map(group => {\n                          return {\n                            key: group.groupSetting.title,\n                            text: group.groupSetting.title\n                          };\n                        }):[]}\n                        styles={dropdownStyles}\n                      />\n                    </div>\n\n                    <div style={{ marginLeft: \"16px\", flexGrow: 0 }}>\n                      <Dropdown\n                        disabled={showTable}\n                        placeholder=\"Select tile size\"\n                        selectedKey={tileSize}\n                        label=\"View as\"\n                        onChanged={(option, index) => {\n                          setTileSize(option.key);\n                          //debugger\n                        }}\n                        options={[\n                          {\n                            key: 0,\n                            text: \"Tile\"\n                          },\n                          {\n                            key: 1,\n                            text: \"Small\"\n                          }\n                        ]}\n                        styles={dropdownStyles}\n                      />\n                    </div> */}\n                  </div>\n                  {showTable && (\n                    <>\n                      <div style={{ textAlign: \"right\" }}>\n                        <i\n                          style={{ cursor: \"pointer\", padding: \"4px\" }}\n                          class=\"ms-Icon ms-Icon--OpenInNewWindow\"\n                          onClick={() => {\n                            window.open(tableUrl, \"_blank\");\n                          }}\n                          aria-hidden=\"true\"\n                        ></i>\n                      </div>\n                      <iframe\n                        style={{\n                          border: \"0\",\n                          height: \"calc(100vh - 150px\",\n                          width: \"95vw\"\n                        }}\n                        src={tableUrl}\n                      ></iframe>\n                    </>\n                  )}\n                  {!showTable && (\n                    <div style={{ display: \"flex\", flexWrap: \"wrap\" }}>\n                      {filteredTiles.length===0 && <div>\n                        <h2>You can request a link if you miss one</h2> \n                        <h1>\n                        <a href=\"https://christianiabpos.sharepoint.com/sites/intranets-tools#missing-a-link\">Request a link</a>\n                        </h1>\n\n                        \n                        </div>}\n                      {filteredTiles.map((tile, key) => {\n                        if (selectedGroup){\n                          var match = false\n                          \n                          if (!tile.references) return <></>\n                          tile.references.forEach(r=>{\n                            if (r.title===selectedGroup){\n                              match = true\n                            }\n                          })\n                          if (!match) return <></>\n                        }\n                        return (\n                          <AppSuperTile\n                            tileSize={tileSize}\n                            key={key}\n                            filter={filter}\n                            highlightStyle={{\n                              backgroundColor: \"yellow\",\n                              color: \"#333\"\n                            }}\n                            tile={tile}\n                            onPinnedClicked={props => {\n                              if (props.tile) {\n                                addTile(props.tile);\n                              }\n                            }}\n                            onClick={tile => {\n                              if (tile.jumpto) {\n                                return window.open(tile.jumpto, \"_blank\");\n                              }\n                              setCurrentTile(tile);\n                              setIsZoomed(true);\n                            }}\n                          />\n                        );\n                      })}\n                    </div>\n                  )}\n                {/* </PivotItem> */}\n                {/* {memberships.length > 0 && (\n                  <PivotItem\n                    headerText=\"Teams\"\n                    itemCount={filteredMemberShips.length}\n                  >\n                    <ViewTeams\n                      memberShips={filteredMemberShips}\n                      filter={filter}\n                      highlightStyle={{ backgroundColor: \"yellow\" }}\n                    />\n                  </PivotItem>\n                )}\n                {false && myTools.length > 0 && (\n                  <PivotItem headerText=\"Grid\" key=\"grid\">\n                    <div>\n                      <div style={{ display: \"flex\", marginTop: \"8px\" }}>\n                        <div style={{ marginLeft: \"16px\", flexGrow: 1 }}></div>\n                        <div style={{ marginLeft: \"16px\" }}>\n                          <div style={{ display: \"flex\" }}>\n                            <div style={{ padding: \"8px\" }}>Edit Layout</div>\n                            <div>\n                              <Toggle\n                                checked={editingLayout}\n                                style={{ marginTop: \"8px\" }}\n                                onChange={(e, checked) => {\n                                  setEditingLayout(checked);\n                                }}\n                              />\n                            </div>\n                          </div>\n                        </div>\n                      </div>\n                      <ToolboxLayout\n                        tools={myTools}\n                        layouts={layouts}\n                        persist={persistLayouts}\n                        editingLayout={editingLayout}\n                        onTileClick={tile => {\n                          setCurrentTile(tile);\n                          setIsZoomed(true);\n                        }}\n                      />\n                    </div>\n                  </PivotItem>\n                )}\n                {errors.length !== 0 && (\n                  <PivotItem\n                    headerText=\"Developer feedback\"\n                    itemCount={errors.length}\n                  >\n                    <div>\n                      <ViewErrors errors={errors} />\n                    </div>\n                  </PivotItem>\n                )} */}\n              {/* </Pivot> */}\n            </div>\n            {showFilterOptions && (\n              <div\n                style={{\n                  borderLeft: \"1px solid #dddddd\",\n                  borderTop: \"1px solid #dddddd\",\n                  padding: \"8px\",\n                  float: \"right\",\n                  minWidth: \"300px\"\n                }}\n              >\n                <div style={{ padding: \"0px\" }}>\n                  <TextField\n                    label=\"Filter\"\n                    value={filter}\n                    onChange={(e, newValue) => {\n                      setFilter(newValue);\n                    }}\n                    placeholder=\"Filter the list of tools\"\n                    iconProps={{ iconName: \"Filter\" }}\n                  />\n                </div>\n              </div>\n            )}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nimport {login} from \"./authenticate\" // autonom library - will force signin\n//import \"./helpers/OfficeGraph\"\n//login()\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","export function getSearchParametersFromHRef(href) {\n  if (!href) return {};\n  var search = {};\n  var s1 = href.split(\"?\");\n  if (s1.length > 1) {\n    var s2 = s1[1].split(\"&\");\n    for (let index = 0; index < s2.length; index++) {\n      const s3 = s2[index].split(\"=\");\n      search[s3[0]] = decodeURIComponent( s3[1]);\n    }\n  }\n  return search;\n}\n\nexport function getSearchParametersFromHash(href) {\n  if (!href) return {};\n  var search = {};\n  var s1 = href.split(\"#\");\n  if (s1.length > 1) {\n    var s2 = s1[1].split(\"&\");\n    for (let index = 0; index < s2.length; index++) {\n      const s3 = s2[index].split(\"=\");\n      search[s3[0]] = decodeURIComponent( s3[1]);\n    }\n  }\n  return search;\n}\n","module.exports = \"data:image/png;base64,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\""],"sourceRoot":""}